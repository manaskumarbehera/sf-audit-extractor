{
  "meta": {
    "version": 1,
    "description": "Guidance rules for the SOQL helper. Each rule may produce a suggestion, warning or error without blocking others."
  },
  "defaults": {
    "emptySuggestion": {
      "title": "Write a focused SOQL query",
      "message": "Start by selecting a small field list and limit the records you pull back."
    }
  },
  "rules": [
    {
      "id": "limit_missing",
      "category": "warning",
      "title": "Add a LIMIT clause",
      "message": "SOQL queries without LIMIT can pull more data than expected.",
      "suggestion": "Append LIMIT <n> to control how many records are returned.",
      "conditions": {
        "all": [
          { "regex": "^\\s*select\\s+[\\s\\S]+\\s+from\\s+", "flags": "i" },
          { "notContains": [" limit "] }
        ]
      }
    },
    {
      "id": "where_missing",
      "category": "suggestion",
      "title": "Filter your query",
      "message": "Filtering helps SOQL run faster and stay within limits.",
      "suggestion": "Add a WHERE clause that narrows the records you need.",
      "conditions": {
        "all": [
          { "regex": "^\\s*select\\s+[\\s\\S]+\\s+from\\s+", "flags": "i" },
          { "notContains": [" where "] }
        ],
        "any": [
          { "contains": [" limit "] },
          { "contains": [" order by "] }
        ]
      }
    },
    {
      "id": "select_star",
      "category": "error",
      "title": "Avoid SELECT *",
      "message": "SOQL does not support SELECT * and it increases payload size.",
      "suggestion": "List the fields you really need instead of using *.",
      "conditions": {
        "all": [
          { "regex": "select\\s+\\*", "flags": "i" }
        ]
      }
    },
    {
      "id": "order_by_without_limit",
      "category": "warning",
      "title": "Pair ORDER BY with LIMIT",
      "message": "ORDER BY can be expensive without a LIMIT.",
      "suggestion": "Use LIMIT when ordering to keep results manageable.",
      "conditions": {
        "all": [
          { "contains": [" order by "] },
          { "notContains": [" limit "] }
        ]
      }
    },
    {
      "id": "count_query_tip",
      "category": "suggestion",
      "title": "COUNT() queries",
      "message": "COUNT() returns a single aggregate row.",
      "suggestion": "Use COUNT() when you only need the record count.",
      "conditions": {
        "all": [
          { "regex": "^\\s*select\\s+count\\s*\\(\\s*\\*?\\s*\\)", "flags": "i" }
        ]
      }
    }
  ]
}

